{% extends 'community/layout.html' %}
{% block ContentView %}
    <br><br><br><br>
    <div class="container">
        <div class="row">
            <div class="col-md-8">
                <div class="card">
                    <div class="card-header border-0 bg-white" style="border-radius:2rem;">
                        <h3>Private Chat</h3>
                    </div>
                    <div class="card-body">
                        <div id="content">
                            {% for value in conv_data %}
                                <p><strong>{{ value.username }} :</strong> {{ value.message }}</p>
                            {% endfor %}
                        </div>
                        <hr>
                        <form method="POST" class="form-inline" action="#formscroll">
                            {% csrf_token %}
                            {{ form.message }}
                            <button type="submit" class="btn btn-light" style="border-radius:0rem 1rem 1rem 0rem;background-color:#b8b7fa" value="1" id="formscroll">Send</button>
                        </form>
                    </div>
                </div>
            </div>
            <div class="col">
                <div class="card">
                    <div class="card-header border-0 bg-white" style="border-radius:2rem;">
                        <h3>More conversations</h3>
                    </div>
                    <div class="card-body">
                        <p>More users</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>alert("hi");</script>
{% endblock %}

{% block Scripts %}
<script>
document.write("HEY");

setInterval(function(){
    res = "{{ conversation_id }}";
    alert("hi");
    $.ajax({
        url:"{% url 'ajax-response' %}",
        method:'GET',
        data : {'conversation_id' : res}, 
        success: function(data) {
            var new_data=data["new_data"];
            $('#content').html('');
            for (i = 0; i < new_data.length; i++) {
                $('#content').append(<p><strong>new_data["username"] :</strong> new_data["message"]</p>);
            }        
        }
    }); 
}, 3000);
</script>
{% endblock %}